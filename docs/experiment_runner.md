# ExperimentRunner: –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä RL –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

## –û–±–∑–æ—Ä

`ExperimentRunner` - —ç—Ç–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –≤ –æ–±–ª–∞—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏—è —Å –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏–µ–º (RL). –û–Ω —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω—ã–º –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞, –≤–∫–ª—é—á–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫—É, –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Å–±–æ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è baseline –∏ variant –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π.

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üöÄ –†–µ–∂–∏–º—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π**: Baseline ‚Üí Variant (–±–µ–∑–æ–ø–∞—Å–Ω–æ, –º–µ–Ω—å—à–µ —Ä–µ—Å—É—Ä—Å–æ–≤)
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π**: Baseline ‚à• Variant (–±—ã—Å—Ç—Ä–µ–µ, –±–æ–ª—å—à–µ —Ä–µ—Å—É—Ä—Å–æ–≤)
- **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –±–µ–∑ –æ–±—É—á–µ–Ω–∏—è

### üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (CPU, –ø–∞–º—è—Ç—å)
- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —á–µ–∫–ø–æ–∏–Ω—Ç–æ–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

### üõ†Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- Graceful handling –Ω–µ—É–¥–∞—á–Ω—ã—Ö –æ–±—É—á–µ–Ω–∏–π
- –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è (abort, retry, skip)
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### üîß –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å `Trainer` –∏ `Experiment`
- CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from src.experiments.experiment import Experiment
from src.experiments.runner import ExperimentRunner, ExecutionMode

# –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ (baseline + variant –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)
experiment = Experiment(
    baseline_config=baseline_config,
    variant_config=variant_config,
    hypothesis="Variant –ø–æ–∫–∞–∂–µ—Ç –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã"
)

# –°–æ–∑–¥–∞–Ω–∏–µ –∏ –∑–∞–ø—É—Å–∫ runner'–∞
runner = ExperimentRunner(
    experiment=experiment,
    execution_mode=ExecutionMode.SEQUENTIAL
)

success = runner.run()
```

### CLI –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ –∏–∑ —Ñ–∞–π–ª–∞
python -m src.experiments.runner --config experiment_config.json

# –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
python -m src.experiments.runner \
    --config experiment_config.json \
    --mode parallel \
    --max-workers 2

# –†–µ–∂–∏–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏
python -m src.experiments.runner \
    --config experiment_config.json \
    --mode validation
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```
ExperimentRunner
‚îú‚îÄ‚îÄ Experiment (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–º)
‚îú‚îÄ‚îÄ Trainer (–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–∏—è)
‚îú‚îÄ‚îÄ ProgressInfo (–æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞)
‚îú‚îÄ‚îÄ ResourceUsage (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤)
‚îî‚îÄ‚îÄ CheckpointManager (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ–∫–ø–æ–∏–Ω—Ç–∞–º–∏)
```

### –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

```
1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
   ‚îú‚îÄ‚îÄ –í–∞–ª–∏–¥–∞—Ü–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞
   ‚îú‚îÄ‚îÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ä–µ–¥—ã
   ‚îî‚îÄ‚îÄ –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

2. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
   ‚îú‚îÄ‚îÄ Baseline –æ–±—É—á–µ–Ω–∏–µ
   ‚îú‚îÄ‚îÄ Variant –æ–±—É—á–µ–Ω–∏–µ
   ‚îî‚îÄ‚îÄ –°–±–æ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

3. –ê–Ω–∞–ª–∏–∑ –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
   ‚îú‚îÄ‚îÄ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
   ‚îú‚îÄ‚îÄ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤
   ‚îî‚îÄ‚îÄ –û—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
```

## –ü–æ–¥—Ä–æ–±–Ω–æ–µ API

### ExperimentRunner

#### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

```python
runner = ExperimentRunner(
    experiment: Experiment,                    # –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
    execution_mode: ExecutionMode = SEQUENTIAL, # –†–µ–∂–∏–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
    max_workers: Optional[int] = None,         # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ—Ä–∫–µ—Ä–æ–≤
    enable_monitoring: bool = True,            # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤
    checkpoint_frequency: int = 10000,         # –ß–∞—Å—Ç–æ—Ç–∞ —á–µ–∫–ø–æ–∏–Ω—Ç–æ–≤
    resource_limits: Optional[Dict] = None     # –õ–∏–º–∏—Ç—ã —Ä–µ—Å—É—Ä—Å–æ–≤
)
```

#### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã

```python
# –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞
success: bool = runner.run()

# –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–¥–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
result: TrainingResult = runner.run_configuration(
    config_type: str,           # "baseline" –∏–ª–∏ "variant"
    config: Configuration,      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
    trainer_config: Optional[TrainerConfig] = None
)

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ä–µ–¥—ã
runner.setup_environment()

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
progress: ProgressInfo = runner.monitor_progress()

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
success: bool = runner.handle_failure(
    error: Exception,
    config_type: Optional[str] = None,
    recovery_strategy: str = "abort"  # "abort", "retry", "skip"
)

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
status: Dict[str, Any] = runner.get_status()

# –û—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
runner.cleanup()
```

### ExecutionMode

```python
class ExecutionMode(Enum):
    SEQUENTIAL = "sequential"    # –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
    PARALLEL = "parallel"       # –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
    VALIDATION = "validation"   # –†–µ–∂–∏–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏
```

### ProgressInfo

```python
@dataclass
class ProgressInfo:
    current_step: int = 0                    # –¢–µ–∫—É—â–∏–π —à–∞–≥
    total_steps: int = 0                     # –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤
    current_phase: str = "idle"              # –¢–µ–∫—É—â–∞—è —Ñ–∞–∑–∞
    baseline_progress: float = 0.0           # –ü—Ä–æ–≥—Ä–µ—Å—Å baseline (%)
    variant_progress: float = 0.0            # –ü—Ä–æ–≥—Ä–µ—Å—Å variant (%)
    estimated_time_remaining: Optional[float] = None  # –û—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è
    current_config: Optional[str] = None     # –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
    
    @property
    def overall_progress(self) -> float:     # –û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å (%)
```

### ResourceUsage

```python
@dataclass
class ResourceUsage:
    cpu_percent: float = 0.0      # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU (%)
    memory_percent: float = 0.0   # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ (%)
    memory_mb: float = 0.0        # –ü–∞–º—è—Ç—å –≤ MB
    disk_usage_mb: float = 0.0    # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞ –≤ MB
    gpu_usage: Optional[float] = None  # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GPU (%)
    
    @classmethod
    def current(cls) -> "ResourceUsage":  # –¢–µ–∫—É—â–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

```python
from src.experiments.runner import ExperimentRunner, ExecutionMode

runner = ExperimentRunner(
    experiment=experiment,
    execution_mode=ExecutionMode.SEQUENTIAL,
    enable_monitoring=True
)

# –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
success = runner.run()

if success:
    print(f"Baseline: {runner.baseline_result.final_mean_reward:.2f}")
    print(f"Variant: {runner.variant_result.final_mean_reward:.2f}")
```

### 2. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

```python
runner = ExperimentRunner(
    experiment=experiment,
    execution_mode=ExecutionMode.PARALLEL,
    max_workers=2,
    resource_limits={
        "memory_mb": 8192,
        "cpu_percent": 80.0
    }
)

success = runner.run()
```

### 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

```python
import threading
import time

def monitor_progress(runner):
    while runner.status != RunnerStatus.COMPLETED:
        progress = runner.monitor_progress()
        status = runner.get_status()
        
        print(f"Phase: {progress.current_phase}")
        print(f"Baseline: {progress.baseline_progress:.1f}%")
        print(f"Variant: {progress.variant_progress:.1f}%")
        print(f"CPU: {status['resource_usage']['cpu_percent']:.1f}%")
        print(f"Memory: {status['resource_usage']['memory_mb']:.1f}MB")
        
        time.sleep(5)

# –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ
monitor_thread = threading.Thread(target=monitor_progress, args=(runner,))
monitor_thread.start()

# –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞
success = runner.run()

monitor_thread.join()
```

### 4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

```python
class CustomExperimentRunner(ExperimentRunner):
    def handle_failure(self, error, config_type=None, recovery_strategy="retry"):
        self.logger.error(f"–û—à–∏–±–∫–∞ –≤ {config_type}: {error}")
        
        if isinstance(error, MemoryError):
            # –£–º–µ–Ω—å—à–∞–µ–º batch_size –∏ –ø–æ–≤—Ç–æ—Ä—è–µ–º
            return self._retry_with_smaller_batch(config_type)
        elif isinstance(error, TimeoutError):
            # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º timeout –∏ –ø–æ–≤—Ç–æ—Ä—è–µ–º
            return self._retry_with_longer_timeout(config_type)
        else:
            # –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
            return super().handle_failure(error, config_type, recovery_strategy)
```

### 5. –†–µ–∂–∏–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏

```python
# –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –±–µ–∑ –æ–±—É—á–µ–Ω–∏—è
runner = ExperimentRunner(
    experiment=experiment,
    execution_mode=ExecutionMode.VALIDATION
)

is_valid = runner.run()

if is_valid:
    print("‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤–∞–ª–∏–¥–Ω—ã, –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ")
else:
    print("‚ùå –ù–∞–π–¥–µ–Ω—ã –æ—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ö")
```

## CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫
python -m src.experiments.runner --config experiment.json

# –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å 4 –≤–æ—Ä–∫–µ—Ä–∞–º–∏
python -m src.experiments.runner \
    --config experiment.json \
    --mode parallel \
    --max-workers 4

# –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
python -m src.experiments.runner \
    --config experiment.json \
    --mode validation

# –ó–∞–ø—É—Å–∫ —Å –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º
python -m src.experiments.runner \
    --config experiment.json \
    --no-monitoring

# –ó–∞–ø—É—Å–∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ –ø–æ ID
python -m src.experiments.runner \
    --experiment-id abc123-def456 \
    --output-dir results/experiments

# –î–µ—Ç–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥
python -m src.experiments.runner \
    --config experiment.json \
    --verbose -v
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã CLI

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|----------|----------|--------------|
| `--config` | –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ | - |
| `--experiment-id` | ID —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ | - |
| `--mode` | –†–µ–∂–∏–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (sequential/parallel/validation) | sequential |
| `--max-workers` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ—Ä–∫–µ—Ä–æ–≤ –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ | 2 |
| `--no-monitoring` | –û—Ç–∫–ª—é—á–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤ | False |
| `--output-dir` | –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ | results/experiments |
| `--verbose, -v` | –£—Ä–æ–≤–µ–Ω—å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ (–º–æ–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä—è—Ç—å) | 0 |

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞

```json
{
  "experiment_id": "ppo_learning_rate_comparison",
  "hypothesis": "–£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π learning rate —É—Å–∫–æ—Ä–∏—Ç –æ–±—É—á–µ–Ω–∏–µ",
  "baseline_config": {
    "algorithm": "PPO",
    "environment": "LunarLander-v2",
    "hyperparameters": {
      "learning_rate": 3e-4,
      "n_steps": 2048,
      "batch_size": 64
    },
    "training_steps": 100000,
    "seed": 42
  },
  "variant_config": {
    "algorithm": "PPO",
    "environment": "LunarLander-v2",
    "hyperparameters": {
      "learning_rate": 1e-3,
      "n_steps": 2048,
      "batch_size": 64
    },
    "training_steps": 100000,
    "seed": 42
  }
}
```

### –õ–∏–º–∏—Ç—ã —Ä–µ—Å—É—Ä—Å–æ–≤

```python
resource_limits = {
    "memory_mb": 8192,      # –ú–∞–∫—Å–∏–º—É–º 8GB –ø–∞–º—è—Ç–∏
    "cpu_percent": 90.0,    # –ú–∞–∫—Å–∏–º—É–º 90% CPU
    "disk_gb": 10.0,        # –ú–∞–∫—Å–∏–º—É–º 10GB –¥–∏—Å–∫–∞
}

runner = ExperimentRunner(
    experiment=experiment,
    resource_limits=resource_limits
)
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–æ–≥–æ–≤

```
results/experiments/{experiment_id}/
‚îú‚îÄ‚îÄ logs/
‚îÇ   ‚îú‚îÄ‚îÄ experiment.log          # –û—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ baseline_training.log   # –õ–æ–≥ –æ–±—É—á–µ–Ω–∏—è baseline
‚îÇ   ‚îú‚îÄ‚îÄ variant_training.log    # –õ–æ–≥ –æ–±—É—á–µ–Ω–∏—è variant
‚îÇ   ‚îî‚îÄ‚îÄ runner.log             # –õ–æ–≥ runner'–∞
‚îú‚îÄ‚îÄ checkpoints/
‚îÇ   ‚îú‚îÄ‚îÄ runner_checkpoint_10000.pkl
‚îÇ   ‚îî‚îÄ‚îÄ runner_checkpoint_20000.pkl
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ baseline_model_final.zip
‚îÇ   ‚îî‚îÄ‚îÄ variant_model_final.zip
‚îî‚îÄ‚îÄ runner_final_state.yaml    # –§–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
```

### –ú–µ—Ç—Ä–∏–∫–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫
status = runner.get_status()

print(f"–°—Ç–∞—Ç—É—Å: {status['status']}")
print(f"–†–µ–∂–∏–º: {status['execution_mode']}")
print(f"–ü—Ä–æ–≥—Ä–µ—Å—Å: {status['progress']['overall']:.1f}%")
print(f"CPU: {status['resource_usage']['cpu_percent']:.1f}%")
print(f"–ü–∞–º—è—Ç—å: {status['resource_usage']['memory_mb']:.1f}MB")
print(f"–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: {status['execution_time']:.1f}—Å")
```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

1. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
   - –£—á–∏—Ç—ã–≤–∞–π—Ç–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–∞–º—è—Ç–∏
   - –û–ø—Ç–∏–º–∞–ª—å–Ω–æ: 2 –≤–æ—Ä–∫–µ—Ä–∞ (baseline + variant)

2. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é**
   - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ —Ä–∞–∑—É–º–Ω—ã–µ –ª–∏–º–∏—Ç—ã
   - –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —á–µ–∫–ø–æ–∏–Ω—Ç—ã –¥–ª—è –±–æ–ª—å—à–∏—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

3. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è I/O**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ SSD –¥–ª—è —á–µ–∫–ø–æ–∏–Ω—Ç–æ–≤
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —á–∞—Å—Ç–æ—Ç—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
   - –û—á–∏—â–∞–π—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

| –ü—Ä–æ–±–ª–µ–º–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|----------|---------|---------|
| Out of Memory | –ë–æ–ª—å—à–∏–µ –º–æ–¥–µ–ª–∏/–±–∞—Ç—á–∏ | –£–º–µ–Ω—å—à–∏—Ç—å batch_size, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —á–µ–∫–ø–æ–∏–Ω—Ç—ã |
| –ú–µ–¥–ª–µ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ | CPU bottleneck | –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ |
| –ü—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ –æ–±—É—á–µ–Ω–∏—è | –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Å—Ä–µ–¥—ã | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∏, –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π |
| –ü–æ—Ç–µ—Ä—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ | –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —á–µ–∫–ø–æ–∏–Ω—Ç–æ–≤ | –£–≤–µ–ª–∏—á–∏—Ç—å —á–∞—Å—Ç–æ—Ç—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è |

## –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

```python
class CustomRecoveryRunner(ExperimentRunner):
    def handle_failure(self, error, config_type=None, recovery_strategy="custom"):
        if recovery_strategy == "custom":
            # –ö–∞—Å—Ç–æ–º–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
            return self._custom_recovery(error, config_type)
        return super().handle_failure(error, config_type, recovery_strategy)
    
    def _custom_recovery(self, error, config_type):
        # –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–∫–∏ –∏ –ø—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏—è
        if "memory" in str(error).lower():
            return self._reduce_memory_usage(config_type)
        elif "timeout" in str(error).lower():
            return self._extend_timeout(config_type)
        return False
```

### –ö–∞—Å—Ç–æ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

```python
class EnhancedRunner(ExperimentRunner):
    def _start_monitoring(self):
        super()._start_monitoring()
        # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫
        self._start_gpu_monitoring()
        self._start_network_monitoring()
    
    def _start_gpu_monitoring(self):
        # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ GPU –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω
        try:
            import GPUtil
            # –õ–æ–≥–∏–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ GPU
        except ImportError:
            pass
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
pytest tests/test_experiment_runner.py -v

# –ë—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã (–±–µ–∑ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö)
pytest tests/test_experiment_runner.py -v -m "not slow"

# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
pytest tests/test_experiment_runner.py -v -m "integration"

# –¢–µ—Å—Ç—ã —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pytest tests/test_experiment_runner.py --cov=src.experiments.runner --cov-report=html
```

### –ú–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —Ç–µ—Å—Ç–æ–≤

```python
@patch('src.experiments.runner.Trainer')
def test_custom_scenario(mock_trainer_class):
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–∫–∞
    mock_trainer = Mock()
    mock_trainer.train.return_value = mock_training_result
    mock_trainer_class.return_value = mock_trainer
    
    # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
    runner = ExperimentRunner(experiment)
    result = runner.run_configuration("baseline", config)
    
    assert result.success
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

`ExperimentRunner` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–æ—â–Ω—ã–π –∏ –≥–∏–±–∫–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã—Ö RL —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤. –û–Ω –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã –≤ –µ–¥–∏–Ω—ã–π, –Ω–∞–¥–µ–∂–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–π:

- ‚úÖ –ù–∞–¥–µ–∂–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
- ‚úÖ –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å
- ‚úÖ –ì–∏–±–∫–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–π –∏ –º–æ—â–Ω—ã–π API
- ‚úÖ CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ü–æ–ª–Ω—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å —ç–∫–æ—Å–∏—Å—Ç–µ–º–æ–π –ø—Ä–æ–µ–∫—Ç–∞

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å–º. –ø—Ä–∏–º–µ—Ä—ã –≤ `examples/experiment_runner_example.py` –∏ —Ç–µ—Å—Ç—ã –≤ `tests/test_experiment_runner.py`.