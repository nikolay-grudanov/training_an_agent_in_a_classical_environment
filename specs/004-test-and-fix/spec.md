# Feature Specification: –§–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –æ—Ç–ª–∞–¥–∫–∞ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è RL –ø—Ä–æ–µ–∫—Ç–∞

**Feature Branch**: `004-test-and-fix`
**Created**: 2026-02-04
**Status**: Draft
**Input**: –ü–ª–∞–Ω –∏–∑ 004-test-and-fix-experiments.md - 13 —Ñ–∞–∑ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ—Ç–ª–∞–¥–∫–∏

## 2. Context & Background

### –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ PPO –∞–≥–µ–Ω—Ç –æ–±—É—á–µ–Ω –Ω–∞ LunarLander-v3
- ‚úÖ –¶–µ–ª–µ–≤–∞—è –Ω–∞–≥—Ä–∞–¥–∞ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞: 229.15 (GPU) / 203.15 (CPU)
- ‚úÖ –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã: Python 3.10.14, PyTorch 2.5.1+rocm6.2, SB3 2.7.1
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞: ~4,500 —Å—Ç—Ä–æ–∫
- ‚úÖ –ö–æ–¥ –ø—Ä–æ—à–µ–ª Ruff linting –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚ö†Ô∏è –¢–µ—Å—Ç—ã: 603/637 (94.7%) - 33 –ø—Ä–æ–≤–∞–ª–µ–Ω–æ (—É—Å—Ç–∞—Ä–µ–≤—à–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏)

### –¶–µ–ª—å —Ñ–∞–∑—ã
–§–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –æ—Ç–ª–∞–¥–∫–∞ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—Å–µ–≥–æ RL –ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –Ω–∞–¥–µ–∂–Ω–æ–π —Ä–∞–±–æ—Ç—ã –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤. –û–±–µ—Å–ø–µ—á–∏—Ç—å 100% –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤, –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –ø–æ–ª–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é.

## 3. User Scenarios & Testing

### User Story 1: –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è (Priority: P1)

–ö–∞–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ RL –ø—Ä–æ–µ–∫—Ç–∞, —è —Ö–æ—á—É –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è –≤ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –∏ –æ–±—É—á–µ–Ω–∏—é –±–µ–∑ –æ—à–∏–±–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–∫–∏.

**Why this priority**: –ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –≤—Å–µ—Ö –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö —Ñ–∞–∑; –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∏—á–µ–≥–æ –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è.

**Independent Test**: –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑ –§–∞–∑—ã 1 –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—ã–≤–æ–¥.

**Acceptance Scenarios**:
1. **Given** –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞ —Å—Ä–µ–¥–∞ `rocm`, **When** –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è `python --version`, **Then** –≤—ã–≤–æ–¥–∏—Ç—Å—è `Python 3.10.14`.
2. **Given** PyTorch –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω, **When** –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è `torch.cuda.is_available()`, **Then** –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `True` –∏ GPU `AMD Radeon RX 7800 XT`.
3. **Given** –≤—Å–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, **When** –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è `pip list | grep ...`, **Then** –≤–µ—Ä—Å–∏–∏: SB3 2.7.1, Gymnasium, PyTorch 2.5.1+rocm6.2.
4. **Given** `gym.make('LunarLander-v3')`, **When** —Å—Ä–µ–¥–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è, **Then** –Ω–µ—Ç –æ—à–∏–±–æ–∫ –∏ —Å—Ä–µ–¥–∞ –≥–æ—Ç–æ–≤–∞.

### User Story 2: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞ (Priority: P1)

–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, —è —Ö–æ—á—É –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–∞–∑–æ–≤–æ–µ –æ–±—É—á–µ–Ω–∏–µ PPO —Å default –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (200K —à–∞–≥–æ–≤), —á—Ç–æ–±—ã –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —Ä–∞–±–æ—Ç—É –ø–∞–π–ø–ª–∞–π–Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –∏ –º–µ—Ç—Ä–∏–∫.

**Why this priority**: –ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç –≤—Å–µ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞; –≤—ã—è–≤–ª—è–µ—Ç —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã.

**Independent Test**: –ó–∞–ø—É—Å—Ç–∏—Ç—å `python -m src.experiments.completion.baseline_training --algo ppo --timesteps 200000 --seed 42` –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã.

**Acceptance Scenarios**:
1. **Given** —á–∏—Å—Ç–∞—è `results/`, **When** –∑–∞–ø—É—â–µ–Ω–æ –±–∞–∑–æ–≤–æ–µ –æ–±—É—á–µ–Ω–∏–µ, **Then** –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –∑–∞ ~5 –º–∏–Ω –±–µ–∑ –æ—à–∏–±–æ–∫.
2. **Given** –æ–±—É—á–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ, **When** –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è —Ñ–∞–π–ª—ã, **Then** —Å–æ–∑–¥–∞–Ω—ã `ppo_seed42_model.zip`, `metrics.csv`, —á–µ–∫–ø–æ–∏–Ω—Ç—ã.
3. **Given** `metrics.csv`, **When** `head -20`, **Then** –º–µ—Ç—Ä–∏–∫–∏ –∑–∞–ø–∏—Å–∞–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.
4. **Given** config.json, **Then** –ø–∞—Ä–∞–º–µ—Ç—Ä—ã default —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã.

### User Story 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (Priority: P1)

–ö–∞–∫ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä, —è —Ö–æ—á—É –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å PPO —Å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (500K —à–∞–≥–æ–≤, CPU), —á—Ç–æ–±—ã –¥–æ—Å—Ç–∏—á—å –Ω–∞–≥—Ä–∞–¥—ã >200.

**Why this priority**: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —Ü–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞ (reward >200).

**Independent Test**: –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ CPU/GPU –∏ —Å—Ä–∞–≤–Ω–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏.

**Acceptance Scenarios**:
1. **Given** –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ params, **When** –æ–±—É—á–µ–Ω–∏–µ 500K –Ω–∞ CPU, **Then** reward >200, std <100.
2. **Given** –∑–∞–ø—É—Å–∫ –Ω–∞ GPU, **When** –ø—Ä–æ–≤–µ—Ä–∫–∞, **Then** –≤—Ä–µ–º—è ~10-12 –º–∏–Ω, –Ω–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –Ω–∞ CPU.
3. **Given** —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ CPU/GPU, **Then** –æ–±–∞ –¥–æ—Å—Ç–∏–≥–∞—é—Ç —Ü–µ–ª–∏.
4. **Given** –ª–æ–≥–∏, **Then** —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞.

### User Story 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ (Priority: P1)

–ö–∞–∫ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–µ—Ä, —è —Ö–æ—á—É –∑–∞–≥—Ä—É–∑–∏—Ç—å –æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å 10 —ç–ø–∏–∑–æ–¥–æ–≤, —á—Ç–æ–±—ã –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π.

**Why this priority**: –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π.

**Independent Test**: –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏.

**Acceptance Scenarios**:
1. **Given** —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å, **When** `PPO.load()`, **Then** –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫.
2. **Given** 10 —ç–ø–∏–∑–æ–¥–æ–≤ deterministic, **When** –∏–Ω—Ñ–µ—Ä–µ–Ω—Å, **Then** mean reward >200.
3. **Given** —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, **Then** std <100, –≤—Å–µ —ç–ø–∏–∑–æ–¥—ã —É—Å–ø–µ—à–Ω—ã.
4. **Given** –≤–∏–¥–µ–æ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è, **Then** –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

### User Story 5: –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã (Priority: P1)

–ö–∞–∫ QA-–∏–Ω–∂–µ–Ω–µ—Ä, —è —Ö–æ—á—É –ø—Ä–æ–≥–Ω–∞—Ç—å –≤—Å–µ unit-—Ç–µ—Å—Ç—ã, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –º–æ–¥—É–ª–µ–π.

**Why this priority**: Unit —Ç–µ—Å—Ç—ã - –æ—Å–Ω–æ–≤–∞ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞.

**Independent Test**: `pytest tests/unit/ -v --cov`.

**Acceptance Scenarios**:
1. **Given** –≤—Å–µ unit —Ç–µ—Å—Ç—ã, **When** `pytest tests/unit/`, **Then** 100% passed (–∏–ª–∏ >95%).
2. **Given** coverage, **Then** >90%.
3. **Given** failed —Ç–µ—Å—Ç—ã, **When** –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã, **Then** –ø–µ—Ä–µ–ø—Ä–æ–≥–æ–Ω –ø—Ä–æ—Ö–æ–¥–∏—Ç.
4. **Given** HTML report, **Then** –¥–æ—Å—Ç—É–ø–µ–Ω –≤ `htmlcov/`.

### User Story 6: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (Priority: P2)

–ö–∞–∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä, —è —Ö–æ—á—É –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ integration —Ç–µ—Å—Ç—ã.

**Why this priority**: –í–∞–∂–Ω–æ –¥–ª—è E2E, –Ω–æ –ø–æ—Å–ª–µ unit.

**Independent Test**: `pytest tests/integration/ -v`.

**Acceptance Scenarios**:
1. **Given** integration —Ç–µ—Å—Ç—ã, **When** –ø—Ä–æ–≥–æ–Ω, **Then** –≤—Å–µ passed.
2. **Given** –ø–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω —Ç–µ—Å—Ç, **Then** –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Å–æ–∑–¥–∞—é—Ç—Å—è.
3. **Given** –º–µ—Ç—Ä–∏–∫–∏, **Then** —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å –æ–∂–∏–¥–∞–µ–º—ã–º–∏.
4. **Given** –∫–æ–Ω—Ñ–∏–≥–∏, **Then** –≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç.

### User Story 7: –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞ (Priority: P1)

–ö–∞–∫ maintainer, —è —Ö–æ—á—É –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞ (linting, types, docs).

**Why this priority**: –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç maintainability.

**Independent Test**: `ruff check .`, `mypy src/ --strict`.

**Acceptance Scenarios**:
1. **Given** –∫–æ–¥, **When** `ruff check . --fix`, **Then** 0 issues.
2. **Given** `ruff format .`, **Then** —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–æ.
3. **Given** type hints, **When** `mypy --strict`, **Then** no errors.
4. **Given** docstrings, **Then** –≤ Google style.

### User Story 8: –ë–µ–Ω—á–º–∞—Ä–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (Priority: P2)

–ö–∞–∫ performance engineer, —è —Ö–æ—á—É –∑–∞–º–µ—Ä–∏—Ç—å –≤—Ä–µ–º—è –∏ –ø–∞–º—è—Ç—å –æ–±—É—á–µ–Ω–∏—è.

**Why this priority**: –í–∞–∂–Ω–æ –¥–ª—è scalability, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ.

**Independent Test**: `time python ... 50K/500K steps`.

**Acceptance Scenarios**:
1. **Given** 50K steps CPU, **When** –∑–∞–º–µ—Ä, **Then** <1 –º–∏–Ω.
2. **Given** 500K steps, **Then** <15 –º–∏–Ω CPU, <12 –º–∏–Ω GPU.
3. **Given** –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, **Then** –ø–∞–º—è—Ç—å <3GB, –Ω–µ—Ç —É—Ç–µ—á–µ–∫.
4. **Given** —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ, **Then** —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–æ.

### User Story 9: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ (Priority: P1)

–ö–∞–∫ scientist, —è —Ö–æ—á—É –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º seed.

**Why this priority**: –ö–ª—é—á –¥–ª—è RL research.

**Independent Test**: –ó–∞–ø—É—Å—Ç–∏—Ç—å 2 —Ä–∞–∑–∞ —Å seed=42, —Å—Ä–∞–≤–Ω–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏.

**Acceptance Scenarios**:
1. **Given** seed=42 run1/run2, **When** —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ `tail metrics.csv`, **Then** –∏–¥–µ–Ω—Ç–∏—á–Ω—ã.
2. **Given** —Ä–∞–∑–Ω—ã–µ seeds (123,999), **Then** —Ä–∞–∑–Ω—ã–µ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏.
3. **Given** seeding utils, **Then** np/torch/random seeded.
4. **Given** deterministic mode, **Then** –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ.

### User Story 10: –û—Ç–ª–∞–¥–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–≥–æ–≤ (Priority: P1)

–ö–∞–∫ debugger, —è —Ö–æ—á—É —Å–æ–±—Ä–∞—Ç—å –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –±–∞–≥–∏.

**Why this priority**: –£—Å—Ç—Ä–∞–Ω—è–µ—Ç –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã.

**Independent Test**: –°–ø–∏—Å–æ–∫ –±–∞–≥–æ–≤ ‚Üí fixes ‚Üí retest phases 1-9.

**Acceptance Scenarios**:
1. **Given** —Å–ø–∏—Å–æ–∫ –±–∞–≥–æ–≤, **When** –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è, **Then** critical/high fixed.
2. **Given** fix, **When** `ruff check && pytest`, **Then** –ø—Ä–æ—Ö–æ–¥–∏—Ç.
3. **Given** –≤—Å–µ —Ñ–∞–∑—ã 1-9, **Then** ‚úÖ.
4. **Given** —Ç–µ—Å—Ç—ã, **Then** 100%.

### User Story 11: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (Priority: P2)

–ö–∞–∫ —Ç—é–Ω–µ—Ä, —è —Ö–æ—á—É –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –µ—Å–ª–∏ reward <200 –∏–ª–∏ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ.

**Why this priority**: –£–ª—É—á—à–µ–Ω–∏–µ, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ.

**Independent Test**: Grid search lr/ent_coef, —Å—Ä–∞–≤–Ω–∏—Ç—å rewards.

**Acceptance Scenarios**:
1. **Given** –∞–Ω–∞–ª–∏–∑, **When** reward <200, **Then** —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —Å lr/ent_coef.
2. **Given** –ª—É—á—à–∏–µ params, **Then** –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã –≤ config.
3. **Given** —Ñ–∏–Ω–∞–ª—å–Ω—ã–π run, **Then** stable >200.
4. **Given** –Ω–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è, **Then** —Ç–µ–∫—É—â–∏–µ –ø—Ä–∏–Ω—è—Ç—ã.

### User Story 12: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ (Priority: P1)

–ö–∞–∫ documenter, —è —Ö–æ—á—É –æ–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ docs —Å –Ω–æ–≤—ã–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏ –∏ troubleshooting.

**Why this priority**: –ü–æ–ª–Ω–∞—è docs –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

**Independent Test**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Å—ã–ª–∫–∏, docstrings.

**Acceptance Scenarios**:
1. **Given** README, **When** –æ–±–Ω–æ–≤–ª–µ–Ω–æ, **Then** quickstart –∫–æ–º–∞–Ω–¥—ã.
2. **Given** TROUBLESHOOTING.md, **Then** –Ω–æ–≤—ã–µ issues.
3. **Given** PROJECT_CONTEXT.md, **Then** —Å—Ç–∞—Ç—É—Å COMPLETED.
4. **Given** –≤—Å–µ docs, **Then** —Å—Å—ã–ª–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç.

### User Story 13: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (Priority: P1)

–ö–∞–∫ releaser, —è —Ö–æ—á—É –ø—Ä–æ–≥–Ω–∞—Ç—å –ø–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω —Å –Ω—É–ª—è –∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≤—Å–µ.

**Why this priority**: –§–∏–Ω–∞–ª—å–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è.

**Independent Test**: Clean ‚Üí full pipeline ‚Üí all tests ‚Üí quality.

**Acceptance Scenarios**:
1. **Given** clean results/, **When** full 500K training, **Then** –≤—Å–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã.
2. **Given** `pytest tests/`, **Then** 100% pass.
3. **Given** `ruff && mypy`, **Then** clean.
4. **Given** plots/video, **Then** —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã.

### Edge Cases
- **Environment/dependencies**: –ù–µ—Ç Box2D ‚Üí install gymnasium[box2d]; ROCm off ‚Üí CPU fallback.
- **Training**: Seed out of range ‚Üí ValueError; timesteps=0 ‚Üí early stop.
- **Inference**: –ö–æ—Ä—Ä—É–º–ø–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å ‚Üí load error —Å log.
- **Testing**: Failed test ‚Üí --last-failed rerun; deprecation warnings ‚Üí ignore.
- **Performance**: High memory ‚Üí batch_size reduce; slow ‚Üí n_epochs down.

## 4. Requirements

### Functional Requirements
- **FR-001**: –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–∂–∏–¥–∞–µ–º—ã–µ –≤–µ—Ä—Å–∏–∏ (Python 3.10.14, PyTorch ROCm, SB3 2.7.1).
- **FR-002**: –ë–∞–∑–æ–≤–æ–µ –æ–±—É—á–µ–Ω–∏–µ (200K) —Å–æ–∑–¥–∞–µ—Ç –º–æ–¥–µ–ª—å, CSV –º–µ—Ç—Ä–∏–∫–∏, —á–µ–∫–ø–æ–∏–Ω—Ç—ã.
- **FR-003**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ (500K) –¥–æ—Å—Ç–∏–≥–∞–µ—Ç reward >200 –Ω–∞ CPU/GPU.
- **FR-004**: –ú–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å –¥–∞–µ—Ç mean reward >200 –Ω–∞ 10 —ç–ø–∏–∑–æ–¥–∞—Ö.
- **FR-005**: –í—Å–µ unit —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —Å coverage >90%.
- **FR-006**: Integration —Ç–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç E2E –ø–∞–π–ø–ª–∞–π–Ω.
- **FR-007**: Ruff/mypy –ø—Ä–æ—Ö–æ–¥—è—Ç –±–µ–∑ –æ—à–∏–±–æ–∫.
- **FR-008**: –ë–µ–Ω—á–º–∞—Ä–∫–∏: 500K <15 –º–∏–Ω, –ø–∞–º—è—Ç—å <3GB.
- **FR-009**: –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å: –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ seeds –¥–∞—é—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏.
- **FR-010**: –í—Å–µ critical/high –±–∞–≥–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã.
- **FR-011**: –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –µ—Å–ª–∏ –Ω—É–∂–Ω–æ (reward >200 stable).
- **FR-012**: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ (README, TROUBLESHOOTING, QUICKSTART).
- **FR-013**: –§–∏–Ω–∞–ª—å–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω —Å –Ω—É–ª—è —Å–æ–∑–¥–∞–µ—Ç –≤—Å–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã.
- **FR-014**: –ú–µ—Ç—Ä–∏–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ CSV/JSON.
- **FR-015**: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ (plots, video) –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è.
- **FR-016**: Seeding –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç reproducibility.

### Non-Functional Requirements
- **NFR-001**: Python –≤–µ—Ä—Å–∏—è —Å—Ç—Ä–æ–≥–æ 3.10.14.
- **NFR-002**: PyTorch 2.5.1+rocm6.2 —Å ROCm –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π.
- **NFR-003**: Stable-Baselines3 2.7.1.
- **NFR-004**: Gymnasium —Å Box2D –¥–ª—è LunarLander-v3.
- **NFR-005**: Performance: 500K steps <15 –º–∏–Ω –Ω–∞ CPU.
- **NFR-006**: Memory usage <3GB.
- **NFR-007**: Reproducibility —Å seed (deterministic mode).
- **NFR-008**: ROCm/GPU –±–µ–∑ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –Ω–∞ CPU.
- **NFR-009**: –ö–æ–¥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç PEP 8 (Ruff/Black).
- **NFR-010**: Type hints –ø–æ–ª–Ω—ã–µ (mypy strict).

### Key Entities
- **Environment**: LunarLander-v3 (Gymnasium).
- **Agent**: PPO (Stable-Baselines3).
- **Experiment**: baseline_training —Å configs.
- **TrainingMetrics**: reward_mean, episode_length, loss_policy (CSV).
- **EvaluationMetrics**: mean_reward, std_reward (eval_log.csv).
- **TrainedModel**: .zip —Ñ–∞–π–ª PPO.
- **Checkpoint**: –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –º–æ–¥–µ–ª–∏.
- **Visualization**: plots.png, video.mp4.

## 5. Success Criteria

### Measurable Outcomes

#### Must Have (Critical)
- **SC-001**: –í—Å–µ unit/integration —Ç–µ—Å—Ç—ã 100% passed.
- **SC-002**: Reward >200 (mean), std <100.
- **SC-003**: –û–±—É—á–µ–Ω–∏–µ 500K <15 –º–∏–Ω.
- **SC-004**: Ruff check/mypy: 0 errors.
- **SC-005**: Coverage >90%.
- **SC-006**: –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å: diff metrics.csv ==0 –¥–ª—è same seed.
- **SC-007**: –ú–æ–¥–µ–ª—å loads/predicts –±–µ–∑ –æ—à–∏–±–æ–∫.
- **SC-008**: –í—Å–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã: model.zip, CSV, checkpoints, plots/video.
- **SC-009**: –ù–µ—Ç critical/high –±–∞–≥–æ–≤.
- **SC-010**: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–ª–Ω–∞—è –∏ —Å—Å—ã–ª–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç.

#### Should Have (Important)
- **SC-011**: Integration —Ç–µ—Å—Ç—ã E2E passed.
- **SC-012**: CPU/GPU benchmarks —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω—ã.
- **SC-013**: –ü–∞–º—è—Ç—å <2GB CPU, <3GB GPU.
- **SC-014**: Docstrings Google style.
- **SC-015**: QUICKSTART.md —Å –∫–æ–º–∞–Ω–¥–∞–º–∏.
- **SC-016**: –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –≤ PROJECT_COMPLETION_REPORT.md.

#### Nice to Have (Optional)
- **SC-017**: Reward >250.
- **SC-018**: –í—Ä–µ–º—è 500K <10 –º–∏–Ω.
- **SC-019**: Coverage >95%.
- **SC-020**: A2C/TD3 agents —Ç–æ–∂–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã.

## 6. Implementation Notes

- **Current status**:
  | –§–∞–∑–∞ | –°—Ç–∞—Ç—É—Å |
  |------|--------|
  | 1 | üü° –í –ø—Ä–æ—Ü–µ—Å—Å–µ |
  | 2-4 | ‚ö™ –ù–µ –Ω–∞—á–∞—Ç–æ |
  | 5 | ‚ö†Ô∏è 603/637 |
  | 6-13 | ‚ö™ –ù–µ –Ω–∞—á–∞—Ç–æ |

- **Known issues**: 33 failed —Ç–µ—Å—Ç–∞ (outdated funcs –≤ test_a2c_agent.py etc.); GPU warnings –Ω–∞ CPU.
- **Dependencies**: –ù–µ—Ç –Ω–æ–≤—ã—Ö; –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å rocm env.
- **Testing Strategy**:
  1. Unit: pytest unit/.
  2. Integration: pytest integration/.
  3. E2E: full pipeline.
  4. Performance: time + htop.
  5. Reproducibility: multi-run same seed.
- **Rollback Plan**: git checkout main; rm -rf results/.
- **Deployment Notes**: –ù–µ—Ç –¥–µ–ø–ª–æ—è; –ª–æ–∫–∞–ª—å–Ω—ã–π run. –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –≤ results/ (gitignore).