# CPU vs GPU: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–∏—è PPO –∞–≥–µ–Ω—Ç–∞ –Ω–∞ LunarLander-v3

## 1. –†–µ–∑—é–º–µ 
–ö—Ä–∞—Ç–∫–∏–π –æ–±–∑–æ—Ä —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏—è PPO –∞–≥–µ–Ω—Ç–∞ –Ω–∞ CPU –∏ GPU (ROCm).

**–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã:**
- CPU –≤ **2.55 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ** GPU (ROCm) –¥–ª—è 50K —à–∞–≥–æ–≤.
- –û–±–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –¥–æ—Å—Ç–∏–≥–ª–∏ —Ü–µ–ª–∏ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ (>200 —Å—Ä–µ–¥–Ω–µ–≥–æ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏—è).
- GPU –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —á—É—Ç—å –ª—É—á—à—É—é —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å (–º–µ–Ω—å—à–µ–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ), –Ω–æ —Å –Ω–∏–∑–∫–æ–π —É—Ç–∏–ª–∏–∑–∞—Ü–∏–µ–π.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **CPU** –¥–ª—è –ø–æ–ª–∏—Ç–∏–∫ MLP –Ω–∞ —Å–∏—Å—Ç–µ–º–∞—Ö —Å ROCm.

## 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ 
- **–ê–ª–≥–æ—Ä–∏—Ç–º:** PPO (Proximal Policy Optimization) –∏–∑ Stable-Baselines3.
- **–°—Ä–µ–¥–∞:** LunarLander-v3 (Gymnasium[box2d]).
- **–®–∞–≥–∏ –æ–±—É—á–µ–Ω–∏—è:** 50K (–¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏) –∏ 500K (—Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã).
- **–°–∏–¥:** 42 (–¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏).
- **–ê–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ:**
  | –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
  |-----------|----------|
  | GPU | AMD Radeon RX 7800 XT (ROCm 6.2) |
  | CPU | –ú–Ω–æ–≥–æ—è–¥–µ—Ä–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä (–ø–æ–ª–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —è–¥–µ—Ä) |
- **–ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ:** PyTorch 2.5.1+rocm6.2, Stable-Baselines3 2.7.1, Gymnasium, NumPy.

## 3. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è 

### –¢–∞–±–ª–∏—Ü–∞ 1: –°–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è (50K —à–∞–≥–æ–≤)
| –ú–µ—Ç—Ä–∏–∫–∞          | GPU (ROCm)   | CPU         | –£—Å–∫–æ—Ä–µ–Ω–∏–µ     |
|------------------|--------------|-------------|---------------|
| –í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è   | 37.5 —Å–µ–∫     | 14.7 —Å–µ–∫    | **CPU 2.55x –±—ã—Å—Ç—Ä–µ–µ** |
| –°–∫–æ—Ä–æ—Å—Ç—å         | 1,333 it/s   | 3,401 it/s  | **2.55x –±—ã—Å—Ç—Ä–µ–µ** |

### –¢–∞–±–ª–∏—Ü–∞ 2: –§–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (500K —à–∞–≥–æ–≤, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã)
| –ú–µ—Ç—Ä–∏–∫–∞          | GPU (ROCm)     | CPU             | –†–∞–∑–Ω–∏—Ü–∞              |
|------------------|----------------|-----------------|----------------------|
| –°—Ä–µ–¥–Ω–µ–µ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏–µ | 229.15 ¬± 17.62 | 203.15 ¬± 53.74 | -11% (GPU –ª—É—á—à–µ)    |
| –°—Ç–¥. –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ  | 17.62          | 53.74           | CPU –Ω–∞ 205% –±–æ–ª—å—à–µ  |
| –í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è   | 191.1 —Å (3.2 –º–∏–Ω) | 191.7 —Å (3.2 –º–∏–Ω) | –ü–æ—á—Ç–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ    |
| –°–∫–æ—Ä–æ—Å—Ç—å         | 3,062 it/s     | 2,976 it/s      | -3% (CPU —á—É—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ) |
| –°—Ö–æ–¥–∏–º–æ—Å—Ç—å       | –î–ê             | –î–ê              | –û–±–∞ >200 —Ü–µ–ª–∏      |

## 4. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ üîç

### 4.1 –ü—Ä–æ–±–ª–µ–º—ã GPU (ROCm) 
- –£—Ç–∏–ª–∏–∑–∞—Ü–∏—è GPU –≤—Å–µ–≥–æ **5-10%** (–æ—á–µ–Ω—å –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ).
- PyTorch —Å ROCm –¥–æ–±–∞–≤–ª—è–µ—Ç –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ –ø–µ—Ä–µ–≤–æ–¥ HIP‚ÜíCUDA.
- –ù–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö CPU‚ÜîGPU –ø—Ä–µ–≤—ã—à–∞—é—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞.
- –ü–æ–ª–∏—Ç–∏–∫–∏ MLP –∏—Å–ø–æ–ª—å–∑—É—é—Ç –º–∞–ª–µ–Ω—å–∫–∏–µ –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–µ —Å–µ—Ç–∏ (~10K –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤).
- –ú–∞–ª–µ–Ω—å–∫–∏–µ –º–∞—Ç—Ä–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–µ –≤—ã–∏–≥—Ä—ã–≤–∞—é—Ç –æ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏–∏ GPU.

### 4.2 –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ CPU 
- –ë–æ–ª—å—à–æ–π L3-–∫—ç—à –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö –º–∞—Ç—Ä–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.
- –ù–µ—Ç –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö.
- –ü–æ–ª–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —è–¥–µ—Ä CPU –¥–ª—è –ø—Ä—è–º–æ–≥–æ/–æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ö–æ–¥–∞ MLP.
- –õ—É—á—à–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —à–∞–±–ª–æ–Ω–∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –º–∞–ª–µ–Ω—å–∫–∏—Ö —Å–µ—Ç–µ–π.

### 4.3 –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ ROCm
- AMD GPU –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ROCm (–Ω–µ CUDA).
- –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è `HIP_VISIBLE_DEVICES` (–Ω–µ —Ç–æ–ª—å–∫–æ `CUDA_VISIBLE_DEVICES`).
- –ü—Ä–æ–±–ª–µ–º—ã —Å –±—ç–∫–µ–Ω–¥–æ–º hipBLASLt –Ω–∞ AMD Radeon RX 7800 XT.
- Fallback –Ω–∞ hipblas —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è–º–∏.

## 5. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞ 

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ GPU –¥–∞–∂–µ –ø—Ä–∏ `device='cpu'`:
```
UserWarning: You are trying to run PPO on the GPU, but it is primarily intended to run on the CPU
```

**–†–µ—à–µ–Ω–∏–µ:** –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω —Ñ–∞–π–ª `src/experiments/completion/baseline_training.py`

–î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU:
```python
# Force CPU by hiding GPU if device='cpu' is requested
if args.device == "cpu":
    os.environ["CUDA_VISIBLE_DEVICES"] = ""
    os.environ["HIP_VISIBLE_DEVICES"] = ""  # Required for ROCm!
    print("[INFO] Forcing CPU by hiding GPU")
```

**–ö–ª—é—á–µ–≤–æ–π –∏–Ω—Å–∞–π—Ç:** –î–ª—è —Å–∏—Å—Ç–µ–º ROCm —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ –æ–±–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
- `CUDA_VISIBLE_DEVICES=""` ‚Äî —Å–∫—Ä—ã–≤–∞–µ—Ç GPU –æ—Ç PyTorch/CUDA.
- `HIP_VISIBLE_DEVICES=""` ‚Äî —Å–∫—Ä—ã–≤–∞–µ—Ç GPU –æ—Ç ROCm/HIP.

## 6. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ 

### –î–ª—è —Å–∏—Å—Ç–µ–º ROCm (AMD GPU):
-  **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ CPU** –¥–ª—è –ø–æ–ª–∏—Ç–∏–∫ MLP (–±–µ–∑ CNN/RNN).
-  –£–∫–∞–∑—ã–≤–∞–π—Ç–µ `--device cpu` –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π GPU.
-  –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ –æ–±–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: `CUDA_VISIBLE_DEVICES="" HIP_VISIBLE_DEVICES=""`.

### –î–ª—è —Å–∏—Å—Ç–µ–º NVIDIA CUDA:
- –ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –≤—ã–≤–æ–¥—ã: CPU –±—ã—Å—Ç—Ä–µ–µ –¥–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö MLP-—Å–µ—Ç–µ–π.
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ `CUDA_VISIBLE_DEVICES=""`.

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GPU:
- –ü–æ–ª–∏—Ç–∏–∫–∏ CNN (–Ω–∞–±–ª—é–¥–µ–Ω–∏—è-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è).
- –ë–æ–ª—å—à–∏–µ —Å–µ—Ç–∏ (>1M –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤).
- –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö —Å—Ä–µ–¥.
- –£—Ç–∏–ª–∏–∑–∞—Ü–∏—è GPU >50%.

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CPU:
- –ü–æ–ª–∏—Ç–∏–∫–∏ MLP (–≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è).
- –ú–∞–ª–µ–Ω—å–∫–∏–µ —Å–µ—Ç–∏ (<100K –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤).
- –û–±—É—á–µ–Ω–∏–µ –Ω–∞ –æ–¥–Ω–æ–π —Å—Ä–µ–¥–µ.
- –°–∏—Å—Ç–µ–º—ã —Å–æ —Å–ª–∞–±—ã–º GPU –∏–ª–∏ –≤—ã—Å–æ–∫–∏–º overhead.

## 7. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ 

**–ò—Ç–æ–≥:**
- –û–±—É—á–µ–Ω–∏–µ –Ω–∞ CPU **–≤ 2.55 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ** GPU (ROCm) –¥–ª—è PPO —Å –ø–æ–ª–∏—Ç–∏–∫–æ–π MLP.
- –û–±–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –¥–æ—Å—Ç–∏–≥–ª–∏ —Ü–µ–ª–∏ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ (>200 –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏—è).
- GPU –¥–∞–ª–æ —á—É—Ç—å –ª—É—á—à—É—é —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å (–º–µ–Ω—å—à–µ–µ std dev).
- CPU –±–æ–ª–µ–µ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ –∏ –±–µ–∑ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π.

**–§–∏–Ω–∞–ª—å–Ω–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
–î–ª—è LunarLander-v3 –∏ –ø–æ–¥–æ–±–Ω—ã—Ö —Å—Ä–µ–¥ —Å –ø–æ–ª–∏—Ç–∏–∫–∞–º–∏ MLP **–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ CPU** –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. GPU —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏:
1. –ü–æ–ª–∏—Ç–∏–∫–∏ CNN.
2. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å—Ä–µ–¥.
3. –ë–æ–ª—å—à–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å–µ—Ç–µ–π.

**–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è:**
```bash
python -m src.experiments.completion.baseline_training \
    --algo ppo \
    --timesteps 500000 \
    --seed 42 \
    --gamma 0.999 \
    --ent-coef 0.01 \
    --gae-lambda 0.98 \
    --n-steps 1024 \
    --n-epochs 4 \
    --device cpu
```

## 8. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ üìé

### A. –°–≤–æ–¥–∫–∞ –≤—Å–µ—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
| –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç | –®–∞–≥–∏ | –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ | –í—Ä–µ–º—è (—Å) | –°—Ä–µ–¥–Ω–µ–µ reward | Std |
|-------------|------|------------|-----------|----------------|-----|
| GPU 50K    | 50K | GPU       | 37.5     | -              | -   |
| CPU 50K    | 50K | CPU       | 14.7     | -              | -   |
| GPU 500K   | 500K| GPU       | 191.1    | 229.15         | 17.62 |
| CPU 500K   | 500K| CPU       | 191.7    | 203.15         | 53.74 |

### B. –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
- **GPU:** AMD Radeon RX 7800 XT, ROCm 6.2.
- **CPU:** –ú–Ω–æ–≥–æ—è–¥–µ—Ä–Ω—ã–π Linux-—Å–µ—Ä–≤–µ—Ä (–¥–µ—Ç–∞–ª–∏: Intel/AMD, >8 —è–¥–µ—Ä).
- **–û–°:** Linux.

### C. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è ROCm
```
export CUDA_VISIBLE_DEVICES=""
export HIP_VISIBLE_DEVICES=""
export PYTORCH_ROCM_ARCH="gfx1100"  # –î–ª—è RX 7800 XT (RDNA3)
```

**–î–∞—Ç–∞ –æ—Ç—á–µ—Ç–∞:** 04 —Ñ–µ–≤—Ä–∞–ª—è 2026 –≥.  
**–ü—Ä–æ–µ–∫—Ç:** RL Agent Training (LunarLander-v3)