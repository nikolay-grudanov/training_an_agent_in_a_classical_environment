# üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ RL Agent Training System

## –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞ 

**–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:** RL Agent Training System  
**–°—Ä–µ–¥–∞:** LunarLander-v3 (Gymnasium)  
**–Ø–∑—ã–∫:** Python 3.10.14  

**–ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:**
- Stable-Baselines3 (PPO, A2C, SAC, TD3)
- Gymnasium (LunarLander-v3)
- PyTorch —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π ROCm
- NumPy, Matplotlib, imageio
- pytest, ruff, mypy

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π production-ready —Å–∏—Å—Ç–µ–º—É –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∞–≥–µ–Ω—Ç–æ–≤ –ø–æ–¥–∫—Ä–µ–ø–ª—è—é—â–µ–≥–æ –æ–±—É—á–µ–Ω–∏—è (RL) –≤ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π —Å—Ä–µ–¥–µ LunarLander-v3. –°–∏—Å—Ç–µ–º–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å:** –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–µ–π
- **–í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å:** –ì–ª–æ–±–∞–ª—å–Ω—ã–µ seed'—ã –∏ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** 200+ unit-—Ç–µ—Å—Ç–æ–≤ + integration-—Ç–µ—Å—Ç—ã
- **–¢–∏–ø–∏–∑–∞—Ü–∏—è:** 100% type hints (mypy strict)
- **–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞:** 100% —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ Ruff/Black

## 1. –î–µ—Ä–µ–≤–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞ 

```
.
‚îú‚îÄ‚îÄ README.md                    # –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ pyproject.toml               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (ruff, pytest, etc.)
‚îú‚îÄ‚îÄ .gitignore                   # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã–µ —Ñ–∞–π–ª—ã (results/, __pycache__/)
‚îú‚îÄ‚îÄ src/                         # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ 
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py              # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–∫–µ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ agents/                  # –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ RL –∞–≥–µ–Ω—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.py              # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å Agent
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ppo_agent.py         # PPO –∞–≥–µ–Ω—Ç (845 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ a2c_agent.py         # A2C –∞–≥–µ–Ω—Ç
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sac_agent.py         # SAC –∞–≥–µ–Ω—Ç
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ td3_agent.py         # TD3 –∞–≥–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ training/                # –ü–∞–π–ø–ª–∞–π–Ω –æ–±—É—á–µ–Ω–∏—è (13 —Ñ–∞–π–ª–æ–≤)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ trainer.py           # –ì–ª–∞–≤–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä (1223 —Å—Ç—Ä–æ–∫–∏)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ train.py             # CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ callbacks.py         # –ö–∞—Å—Ç–æ–º–Ω—ã–µ callbacks
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ checkpoint.py        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ–∫–ø–æ–∏–Ω—Ç–∞–º–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ evaluation.py        # –û—Ü–µ–Ω–∫–∞ –∞–≥–µ–Ω—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ... (10+ —Ñ–∞–π–ª–æ–≤)
‚îÇ   ‚îú‚îÄ‚îÄ experiments/             # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–º–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ completion/          # –ë–∞–∑–æ–≤—ã–µ –∏ gamma —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ baseline_training.py
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ gamma_experiments.py
‚îÇ   ‚îú‚îÄ‚îÄ visualization/           # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ graphs.py            # –ì—Ä–∞—Ñ–∏–∫–∏ –º–µ—Ç—Ä–∏–∫
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ video.py             # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∏–¥–µ–æ
‚îÇ   ‚îú‚îÄ‚îÄ audit/                   # –°–∏—Å—Ç–µ–º–∞ –∞—É–¥–∏—Ç–∞ –∫–æ–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ cleanup/                 # –°–∏—Å—Ç–µ–º–∞ –æ—á–∏—Å—Ç–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ evaluation/              # –û—Ü–µ–Ω–∫–∞ –∞–≥–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ reporting/               # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ utils/                   # –£—Ç–∏–ª–∏—Ç—ã (8 —Ñ–∞–π–ª–æ–≤)
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ seeding.py           # –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å (190 —Å—Ç—Ä–æ–∫)
‚îÇ       ‚îú‚îÄ‚îÄ metrics_exporter.py  # –≠–∫—Å–ø–æ—Ä—Ç –º–µ—Ç—Ä–∏–∫
‚îÇ       ‚îî‚îÄ‚îÄ ... (6+ —Ñ–∞–π–ª–æ–≤)
‚îú‚îÄ‚îÄ tests/                       # –¢–µ—Å—Ç—ã 
‚îÇ   ‚îú‚îÄ‚îÄ unit/                    # Unit-—Ç–µ—Å—Ç—ã (200+)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_seeding.py      # –¢–µ—Å—Ç—ã seeding (152 —Å—Ç—Ä–æ–∫–∏)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ... (199+ —Ñ–∞–π–ª–æ–≤)
‚îÇ   ‚îî‚îÄ‚îÄ integration/             # Integration-—Ç–µ—Å—Ç—ã (6 —Ñ–∞–π–ª–æ–≤)
‚îÇ       ‚îî‚îÄ‚îÄ test_trainer.py
‚îú‚îÄ‚îÄ configs/                     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ YAML
‚îÇ   ‚îú‚îÄ‚îÄ training_schema.yaml
‚îÇ   ‚îî‚îÄ‚îÄ experiment_schema.yaml
‚îú‚îÄ‚îÄ results/                     # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ (gitignore)
‚îÇ   ‚îú‚îÄ‚îÄ experiments/
‚îÇ   ‚îú‚îÄ‚îÄ logs/
‚îÇ   ‚îú‚îÄ‚îÄ metrics/                 # JSON –º–µ—Ç—Ä–∏–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ models/                  # .zip –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ videos/                  # MP4 –≤–∏–¥–µ–æ
‚îÇ   ‚îî‚îÄ‚îÄ reports/                 # –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç—á–µ—Ç—ã
‚îú‚îÄ‚îÄ pytest.ini                   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤
‚îî‚îÄ‚îÄ requirements.txt             # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: `results/` –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è –≤ git. –ü–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è `tree -L 3`.*
[–ü–æ–¥—Ä–æ–±–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π ‚Üí](#2-–æ–ø–∏—Å–∞–Ω–∏—è-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π)

## 2. –û–ø–∏—Å–∞–Ω–∏—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π üìã

###  Root Directory (–ö–æ—Ä–Ω–µ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–æ–µ–∫—Ç–∞, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è.

**–ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã:**
| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|------------|
| `README.md` | –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞, quick start |
| `pyproject.toml` | Ruff, pytest, mypy –∫–æ–Ω—Ñ–∏–≥ |
| `pytest.ini` | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ—Å—Ç–æ–≤ |
| `.gitignore` | –ò–≥–Ω–æ—Ä results/, pycache/ |

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç (–≤–Ω–µ—à–Ω–∏–µ).

###  `src/` - –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ RL –æ–±—É—á–µ–Ω–∏—è.

**–ü–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:**
- `agents/` - –ê–≥–µ–Ω—Ç—ã
- `training/` - –û–±—É—á–µ–Ω–∏–µ
- `utils/` - –£—Ç–∏–ª–∏—Ç—ã

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** stable-baselines3, gymnasium, torch.

#### `src/agents/` 

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ RL –∞–≥–µ–Ω—Ç–æ–≤ (PPO, A2C –∏ –¥—Ä.).

**–ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã:**
- `base.py`: –ë–∞–∑–æ–≤—ã–π `Agent` –∏ `AgentConfig`.
- `ppo_agent.py`: PPO —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –¥–ª—è LunarLander (845 —Å—Ç—Ä–æ–∫).

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** `src.utils`, stable-baselines3.

#### `src/training/`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è (13 —Ñ–∞–π–ª–æ–≤).

**–ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã:**
- `trainer.py`: –ì–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å `Trainer` (1223 —Å—Ç—Ä–æ–∫–∏).

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** `src.agents`, `src.utils`.

#### `src/utils/`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã (8 —Ñ–∞–π–ª–æ–≤).

**–ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã:**
| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|------------|
| `seeding.py` | –ì–ª–æ–±–∞–ª—å–Ω—ã–µ seed'—ã, `SeedManager` |
| `metrics_exporter.py` | –≠–∫—Å–ø–æ—Ä—Ç –≤ JSON |

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** numpy, torch.

###  `tests/`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** 200+ unit-—Ç–µ—Å—Ç–æ–≤, 6 integration.

**–ü–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:**
- `unit/`: Unit-—Ç–µ—Å—Ç—ã (pytest.parametrize).
- `integration/`: E2E —Ç–µ—Å—Ç—ã trainer.

**–ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã:** `test_seeding.py` (152 —Å—Ç—Ä–æ–∫–∏, 100% coverage).

**–ö–æ–º–∞–Ω–¥–∞:** `pytest tests/ --cov=src/ --cov-report=html`


###  `results/`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ (gitignored).

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
results/
‚îú‚îÄ‚îÄ experiments/ppo_baseline/
‚îÇ   ‚îú‚îÄ‚îÄ model.zip
‚îÇ   ‚îî‚îÄ‚îÄ metrics.json
‚îú‚îÄ‚îÄ logs/
‚îú‚îÄ‚îÄ metrics/
‚îú‚îÄ‚îÄ videos/lander.mp4
‚îî‚îÄ‚îÄ reports/
```

## 3. –ü–æ–¥—Ä–æ–±–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –∫–ª—é—á–µ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ 

### `src/training/trainer.py` 

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ì–ª–∞–≤–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –æ–±—É—á–µ–Ω–∏—è.

**–ö–ª—é—á–µ–≤—ã–µ –∫–ª–∞—Å—Å—ã/—Ñ—É–Ω–∫—Ü–∏–∏:**
- `TrainerConfig`: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (dataclass).
- `Trainer`: –£–ø—Ä–∞–≤–ª—è–µ—Ç –∞–≥–µ–Ω—Ç–æ–º, env, callbacks.
- `TrainingResult`: –ú–µ—Ç—Ä–∏–∫–∏ + –ø—É—Ç–∏.
- `create_trainer_from_config()`: –ò–∑ YAML.

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
```python
from src.agents import PPOAgent, A2CAgent
from src.utils import set_seed, RLConfig
import gymnasium, stable_baselines3
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
python -m src.training.trainer --config configs/training_schema.yaml
```

### `src/agents/ppo_agent.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** PPO –∞–≥–µ–Ω—Ç —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –¥–ª—è LunarLander.

**–ö–ª—é—á–µ–≤—ã–µ –∫–ª–∞—Å—Å—ã:**
- `PPOConfig`: –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã (lr=3e-4, n_steps=2048).
- `PPOAgent`: –ù–∞—Å–ª–µ–¥—É–µ—Ç `Agent`.
- `PPOMetricsCallback`, `EarlyStoppingCallback`.

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** stable_baselines3.PPO, VecNormalize.

### `src/utils/seeding.py` 

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å.

**–ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `set_seed(seed: int)`: –ì–ª–æ–±–∞–ª—å–Ω—ã–π seed.
- `SeedManager`: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ seed'–∞–º–∏.
- `verify_reproducibility()`: –¢–µ—Å—Ç.

**–ü—Ä–∏–º–µ—Ä:**
```python
set_seed(42)
```

### –î—Ä—É–≥–∏–µ –∫–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `src/experiments/completion/baseline_training.py` | –ë–∞–∑–æ–≤—ã–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã |
| `src/visualization/graphs.py` | Matplotlib –≥—Ä–∞—Ñ–∏–∫–∏ |
| `src/visualization/video.py` | imageio –≤–∏–¥–µ–æ |


